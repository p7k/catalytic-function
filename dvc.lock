schema: '2.0'
stages:
  download_proteins:
    cmd: python scripts/download_proteins.py
    deps:
    - path: data/ec.txt
      hash: md5
      md5: 374f7839c10d16d6a00476dd2cbc7643
      size: 79737
    - path: scripts/download_proteins.py
      hash: md5
      md5: 09e708b3dad94ab55023baee7e108156
      size: 1237
    params:
      params.yaml:
        download_proteins.BASE_URL: https://rest.uniprot.org/uniprotkb/search?&query=ec
        download_proteins.EC_PATH: data/ec.txt
        download_proteins.SEQUENCE_PATH: data/sequences/sequences.json
    outs:
    - path: data/sequences/sequences.json
      hash: md5
      md5: 8eeb9f718ee378ba4e8ae01f6d0c46fc
      size: 55010704
  make_fasta:
    cmd: python scripts/make_fasta.py
    deps:
    - path: data/sequences/sequences.json
      hash: md5
      md5: 8eeb9f718ee378ba4e8ae01f6d0c46fc
      size: 55010704
    - path: scripts/make_fasta.py
      hash: md5
      md5: 4276b8bcf00d72b6baddf2971a6e7428
      size: 705
    params:
      params.yaml:
        make_fasta.FASTA_PATH: data/sequences/sequences.fasta
        make_fasta.JSON_PATH: data/sequences/sequences.json
    outs:
    - path: data/sequences/sequences.fasta
      hash: md5
      md5: 337dea7c874ce1339b79f40218f6052b
      size: 55361798
  encode_esm:
    cmd: esm-extract esm2_t33_650M_UR50D data/sequences/sequences.fasta   data/embeddings/proteins
      --repr_layers 32 --include mean
    deps:
    - path: data/sequences/sequences.fasta
      hash: md5
      md5: 337dea7c874ce1339b79f40218f6052b
      size: 55361798
    outs:
    - path: data/embeddings/proteins
      hash: md5
      md5: a88c2a5c6b34027456fc9ac830473ed1.dir
      size: 665251408
      nfiles: 111234
